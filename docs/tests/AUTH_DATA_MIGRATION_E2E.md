# 認証とデータ移行の E2E テストケース

## 1. 未ログイン状態での基本機能

### 1.1 書籍管理

- [ ] 書籍を追加できること
- [ ] 書籍の情報を編集できること
- [ ] 書籍を削除できること
- [ ] 追加した書籍がローカルストレージに保存されていること
- [ ] オフライン状態でも書籍の操作が可能なこと

### 1.2 クリップ管理

- [ ] 書籍にクリップを追加できること
- [ ] クリップの内容を編集できること
- [ ] クリップを削除できること
- [ ] 追加したクリップがローカルストレージに保存されていること
- [ ] オフライン状態でもクリップの操作が可能なこと

## 2. 会員登録時のデータ移行

### 2.1 ローカルデータが存在する場合

- [ ] 会員登録時にデータ移行の確認ダイアログが表示されること
- [ ] データ移行中にプログレスバーが表示されること
- [ ] 全ての書籍データが Supabase に正しく移行されること
- [ ] 全てのクリップデータが Supabase に正しく移行されること
- [ ] 移行完了後にローカルデータが削除されること
- [ ] 移行完了後に Supabase のデータが表示されること

### 2.2 ローカルデータが存在しない場合

- [ ] 会員登録が正常に完了すること
- [ ] データ移行の確認ダイアログが表示されないこと
- [ ] Supabase ストレージに切り替わること

### 2.3 エラーケース

- [ ] ネットワークエラー時にエラーメッセージが表示されること
- [ ] データ移行失敗時にエラーメッセージが表示されること
- [ ] エラー発生時にローカルデータが保持されていること
- [ ] リトライ機能が正常に動作すること

## 3. ログイン状態での機能

### 3.1 書籍管理

- [ ] 書籍を追加できること
- [ ] 書籍の情報を編集できること
- [ ] 書籍を削除できること
- [ ] 追加した書籍が Supabase に保存されていること
- [ ] オフライン状態で書籍の追加・編集・削除が制限されること

### 3.2 クリップ管理

- [ ] 書籍にクリップを追加できること
- [ ] クリップの内容を編集できること
- [ ] クリップを削除できること
- [ ] 追加したクリップが Supabase に保存されていること
- [ ] オフライン状態でクリップの追加・編集・削除が制限されること

### 3.3 オフライン制限

- [ ] オフライン状態になった時に適切な警告が表示されること
- [ ] オフライン状態での書籍・クリップの追加が制限されること
- [ ] オンライン復帰時に機能が復活すること

## 4. ログアウト時の動作

### 4.1 基本動作

- [ ] ログアウト時にローカルストレージに切り替わること
- [ ] Supabase のキャッシュデータがクリアされること
- [ ] ローカルストレージが空の状態になること

### 4.2 再ログイン

- [ ] 再ログイン時に Supabase のデータが正しく表示されること
- [ ] 以前追加したデータが全て表示されること

## 5. アカウント削除

### 5.1 基本動作

- [ ] アカウント削除時に Supabase のデータが削除されること
- [ ] ローカルストレージがクリアされること
- [ ] 未ログイン状態に戻ること

### 5.2 エラーケース

- [ ] ネットワークエラー時にエラーメッセージが表示されること
- [ ] アカウント削除失敗時に適切なエラーメッセージが表示されること

## 6. エッジケース

### 6.1 データ整合性

- [ ] 同じデータを複数回移行しようとした場合に重複が発生しないこと
- [ ] 大量のデータ（100 件以上）でも正常に移行できること
- [ ] 特殊文字を含むデータが正しく移行されること

### 6.2 ネットワーク

- [ ] 不安定なネットワーク環境でも正しく動作すること
- [ ] 移行中のネットワーク切断時に適切にエラーハンドリングされること
- [ ] 再接続時に中断したところから再開できること

### 6.3 パフォーマンス

- [ ] データ移行中もアプリの基本的な操作が可能なこと
- [ ] 大量データの移行時でも UI がフリーズしないこと
- [ ] プログレス表示が滑らかに更新されること
